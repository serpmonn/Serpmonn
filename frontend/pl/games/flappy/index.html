<!DOCTYPE html>
<html lang="pl" dir="ltr">
  <head>
<link rel="canonical" href="https://www.serpmonn.ru/frontend/pl/games/flappy/index.html">
<meta property="og:url" content="https://www.serpmonn.ru/frontend/pl/games/flappy/index.html" />
<link rel="stylesheet" href="/frontend/styles/styles.css">
<meta http-equiv="Content-Language" content="pl">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Flappy Bird — Serpmonn</title>
    <meta name="description" content="Flappy Bird: пролетай сквозь трубы, не задев их, и набирай очки.">
    <link rel="icon" href="/frontend/images/serpmonn.ico" type="image/x-icon">
    <link rel="stylesheet" href="/frontend/styles/base.css">
    <link rel="stylesheet" href="/frontend/styles/accessibility.css">
    <link rel="stylesheet" href="/frontend/styles/menu.css">
    <script async src="https://ad.mail.ru/static/ads-async.js"></script>
    <style>
      :root { --bg:#0f141b; --fg:#0b0f14; --pipe:#2ecc71; --bird:#f1c40f; --text:#eaeaea; }
      html, body { width:100%; height:100%; background: var(--bg); overflow:hidden; }
      body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: var(--text); }
      .page { max-width: 1000px; margin: 0 auto; padding: 16px; }
      header { display:flex; align-items:center; gap:12px; margin: 10px 0 16px; }
      header h1 { font-size: 1.6rem; margin: 0; }
      .wrap { display:grid; grid-template-columns: 1fr 320px; gap: 16px; align-items:start; }
      .panel { background: #121821; border: 1px solid #1a2230; border-radius: 10px; padding: 12px 14px; }
      canvas { background: linear-gradient(#6dd5fa, #2980b9); width:100%; max-width:640px; height:auto; border-radius: 10px; border:1px solid #1a2230; box-shadow: 0 8px 30px rgba(0,0,0,.25); display:block; margin:0 auto; }
      .stats { display:grid; grid-template-columns: repeat(2,1fr); gap: 10px; }
      .stat { background:#0f1520; border:1px solid #182233; border-radius:8px; padding:8px 10px; text-align:center; }
      .controls { display:flex; gap:8px; justify-content:center; margin-top:10px; }
      .btn { background:#162030; border:1px solid #24344b; color:#eee; border-radius:8px; padding:8px 10px; cursor:pointer; }
      .btn.primary { background: linear-gradient(90deg, #dc3545, #c82333); border:none; }
      .hint { color:#cfcfcf; font-size:.95rem; text-align:center; margin-top:10px; }
      @media (max-width: 960px) { .wrap{grid-template-columns:1fr;} }
    </style>
  </head>
  <body>
    <div id="menuContainer"></div>
    <script>
      window.showFullScreenAd = window.showFullScreenAd || function(){
        try {
          var ov = document.getElementById('game-ad-overlay');
          if(!ov){
            ov = document.createElement('div');
            ov.id = 'game-ad-overlay';
            ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:9999;';
            var box = document.createElement('div');
            box.style.cssText = 'background:#111;border:1px solid #222;border-radius:12px;padding:12px;text-align:center;max-width:90vw;max-height:90vh;';
            var ins = document.createElement('ins');
            ins.className = 'mrg-tag';
            ins.setAttribute('data-ad-client','ad-1844883');
            ins.setAttribute('data-ad-slot','1844883');
            var btn = document.createElement('button');
            btn.className='btn'; btn.textContent='Продолжить'; btn.style.marginTop='10px';
            btn.onclick=function(){ ov.remove(); };
            box.appendChild(ins); box.appendChild(btn); ov.appendChild(box); document.body.appendChild(ov);
            (window.MRGtag = window.MRGtag || []).push({});
          } else {
            ov.style.display='flex'; (window.MRGtag = window.MRGtag || []).push({});
          }
        } catch(_){}
      };
    </script>
    <div class="page">
      <header>
        <img src="/frontend/images/WebGames.ico" width="28" height="28" alt="Игры" style="border-radius:6px;">
        <h1>Flappy Bird</h1>
      </header>
      <div class="ad-top-banner" style="text-align:center;margin:16px 0;">
        <ins class="mrg-tag" style="display:inline-block;" data-ad-client="ad-1897960" data-ad-slot="1897960"></ins>
      </div>
      <script>(window.MRGtag = window.MRGtag || []).push({});</script>

      <div class="wrap">
        <div class="panel">
          <canvas id="game" width="480" height="640" aria-label="Игровое поле"></canvas>

          <div class="hint" style="display:none;">Управление: Пробел/клик — взмах. Заново — R.</div>
        </div>
        <div class="panel">
          <div class="stats">
            <div class="stat">Счёт<br><b id="score">0</b></div>
            <div class="stat">Рекорд<br><b id="best">0</b></div>
          </div>
          <div class="controls">
            <button class="btn primary" id="btnStart">Старт</button>
            <button class="btn" id="btnReset">Заново</button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/frontend/scripts/menu-loader.js" defer></script>
    <script>
      (function(){
        const W = 240, H = 320, SCALE = 2;
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        canvas.width = W*SCALE; canvas.height = H*SCALE; ctx.scale(SCALE,SCALE);

        const gap = 60; // зазор между трубами
        const pipeWidth = 26;
        const floorY = H - 20;
        const gravity = 0.35;
        const flapVel = -5.2;
        const pipeSpeed = 1.8;

        const bestKey = 'flappy_best_score_v1';
        let best = parseInt(localStorage.getItem(bestKey)||'0',10);
        document.getElementById('best').textContent = String(best);

        let bird, pipes, score, alive, started, timer;

        function reset(){
          bird = { x: 40, y: H/2, vy: 0, r: 6 };
          pipes = []; score = 0; alive = true; started = false;
          spawnPipe();
          draw();
        }

        function spawnPipe(){
          const topH = 30 + Math.floor(Math.random()* (H - gap - 80));
          pipes.push({ x: W+20, top: topH, passed: false });
        }

        function step(){
          if(!alive) return;
          // физика птицы
          if(started){ bird.vy += gravity; }
          bird.y += bird.vy;

          // пол/потолок
          if (bird.y + bird.r > floorY) { bird.y = floorY - bird.r; alive=false; }
          if (bird.y - bird.r < 0) { bird.y = bird.r; bird.vy = 0; }

          // трубы
          for(let i=0;i<pipes.length;i++){
            const p = pipes[i];
            p.x -= pipeSpeed;
            if(!p.passed && p.x + pipeWidth < bird.x){
              p.passed = true; score += 1; updateScore();
              if(score>best){ best=score; localStorage.setItem(bestKey,String(best)); document.getElementById('best').textContent=String(best); }
            }
          }
          if(pipes.length && pipes[0].x + pipeWidth < -10){ pipes.shift(); }
          if(pipes.length===0 || pipes[pipes.length-1].x < W-110){ spawnPipe(); }

          // столкновения с трубами
          for(const p of pipes){
            const topRect = {x:p.x, y:0, w:pipeWidth, h:p.top};
            const botRect = {x:p.x, y:p.top + gap, w:pipeWidth, h:H - (p.top+gap)};
            if (circleRectCollide(bird.x, bird.y, bird.r, topRect) || circleRectCollide(bird.x, bird.y, bird.r, botRect)) {
              alive = false; break;
            }
          }

          draw();
          if(!alive){ gameOver(); }
        }

        function circleRectCollide(cx, cy, cr, r){
          const testX = Math.max(r.x, Math.min(cx, r.x + r.w));
          const testY = Math.max(r.y, Math.min(cy, r.y + r.h));
          const dx = cx - testX; const dy = cy - testY;
          return dx*dx + dy*dy <= cr*cr;
        }

        function draw(){
          // фон неба
          const grad = ctx.createLinearGradient(0,0,0,H);
          grad.addColorStop(0,'#6dd5fa'); grad.addColorStop(1,'#2980b9');
          ctx.fillStyle = grad; ctx.fillRect(0,0,W,H);

          // трубы
          ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--pipe') || '#2ecc71';
          for(const p of pipes){
            ctx.fillRect(p.x, 0, pipeWidth, p.top);
            ctx.fillRect(p.x, p.top + gap, pipeWidth, H - (p.top + gap));
          }

          // земля
          ctx.fillStyle = '#1f2a38';
          ctx.fillRect(0, floorY, W, H-floorY);

          // птица
          ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--bird') || '#f1c40f';
          ctx.beginPath(); ctx.arc(bird.x, bird.y, bird.r, 0, Math.PI*2); ctx.fill();

          // очки
          ctx.fillStyle = '#fff'; ctx.font = 'bold 18px system-ui, -apple-system, Segoe UI, Roboto, Arial'; ctx.textAlign='left';
          ctx.fillText(String(score), 8, 22);
        }

        function updateScore(){ document.getElementById('score').textContent = String(score); }

        function gameOver(){
          ctx.fillStyle = 'rgba(0,0,0,.45)';
          ctx.fillRect(0,0,W,H);
          ctx.fillStyle = '#fff'; ctx.textAlign='center';
          ctx.font = 'bold 22px system-ui, -apple-system, Segoe UI, Roboto, Arial';

          ctx.fillText('Игра окончена', W/2, H/2 - 10);
          ctx.font = '16px system-ui, -apple-system, Segoe UI, Roboto, Arial';
          ctx.fillText('Нажмите R — заново', W/2, H/2 + 18);
          try { if (window.showFullScreenAd) window.showFullScreenAd(); } catch(_){}
        }

        function flap(){ started = true; bird.vy = flapVel; }

        // управление
        canvas.addEventListener('mousedown', flap);
        // мобильный тап
        canvas.addEventListener('touchstart', (e)=>{ e.preventDefault(); flap(); }, {passive:false});
        window.addEventListener('keydown', (e)=>{
          const k=e.key.toLowerCase();
          if(k===' '){ flap(); }
          if(k==='r'){ reset(); }
        });
        document.getElementById('btnStart').addEventListener('click', ()=>{ if(!started){ started=true; } });
        document.getElementById('btnReset').addEventListener('click', reset);

        // цикл
        function loop(){ step(); requestAnimationFrame(loop); }

        // старт
        reset(); updateScore(); loop();
      })();
    </script>
      <script src="/frontend/scripts/mobile-enhancements.js" defer></script>
</body>
</html>
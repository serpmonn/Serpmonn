<!DOCTYPE html>
<html lang="hu" dir="ltr">
  <head>
<link rel="canonical" href="https://www.serpmonn.ru/frontend/hu/tools/logistics/depreciation-calculator.html">
<link rel="stylesheet" href="/frontend/styles/styles.css">
<meta http-equiv="Content-Language" content="hu">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Car Depreciation Calculator ‚Äî Logistics Serpmonn</title>
    <meta name="description" content="–†–∞—Å—á—ë—Ç –∏–∑–Ω–æ—Å–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–æ –ø—Ä–æ–±–µ–≥—É, –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—Å–ª–æ–≤–∏—è–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏">
    <!-- Open Graph -->
    <meta property="og:title" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è ‚Äî –õ–æ–≥–∏—Å—Ç–∏–∫–∞ Serpmonn">
    <meta property="og:description" content="–†–∞—Å—á—ë—Ç –∏–∑–Ω–æ—Å–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π">
    <meta property="og:image" content="https://serpmonn.ru/frontend/images/Banner_Serpmonn.png">
    <meta property="og:url" content="https://www.serpmonn.ru/frontend/hu/tools/logistics/depreciation-calculator.html">
    <meta property="og:type" content="website">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è ‚Äî –õ–æ–≥–∏—Å—Ç–∏–∫–∞ Serpmonn">
    <meta name="twitter:description" content="–†–∞—Å—á—ë—Ç –∏–∑–Ω–æ—Å–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π">
    <meta name="twitter:image" content="https://serpmonn.ru/frontend/images/Banner_Serpmonn.png">
    <link rel="icon" href="/frontend/images/serpmonn.ico" type="image/x-icon">
    <link rel="stylesheet" href="/frontend/styles/base.css">
    <link rel="stylesheet" href="/frontend/styles/accessibility.css">
    <link rel="stylesheet" href="/frontend/styles/menu.css">
    <style>
      .ad-top-banner .mrg-tag { width: 970px !important; height: 250px !important; }
      @media (max-width: 1199px) { .ad-top-banner .mrg-tag { width: 728px !important; height: 90px !important; } }
      @media (max-width: 768px) { .ad-top-banner .mrg-tag { width: 320px !important; height: 50px !important; } }
      body { 
        max-width: 1200px; 
        margin: 0 auto; 
        padding: 16px; 
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
        background: #f5f5f5;
      }
      .breadcrumb {
        margin-bottom: 20px;
        padding: 10px 0;
        color: #666;
        font-size: 0.9rem;
      }
      .breadcrumb a {
        color: #007bff;
        text-decoration: none;
      }
      .breadcrumb a:hover {
        text-decoration: underline;
      }
      h1 { 
        margin: 16px 0; 
        text-align: center;
        color: #333;
      }
      .calculator-container {
        background: #fff;
        border-radius: 12px;
        padding: 24px;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      .error-message {
        display: none;
        color: #dc3545;
        padding: 10px;
        margin-bottom: 10px;
      }
      .error-message:not(.hidden) {
        display: block;
      }
      .input-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .input-group {
        display: flex;
        flex-direction: column;
      }
      label { 
        font-size: 14px; 
        color: #495057; 
        margin-bottom: 8px;
        font-weight: 500;
      }
      input, select { 
        width: 100%; 
        padding: 12px; 
        border: 2px solid #e9ecef; 
        border-radius: 8px; 
        font-size: 16px;
        transition: border-color 0.3s ease;
      }
      input:focus, select:focus {
        outline: none;
        border-color: #007bff;
      }
      .calculate-btn, .reset-btn, .share-btn, .export-btn, .csv-btn {
        background: linear-gradient(90deg, #007bff, #0056b3);
        color: #fff;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 20px 10px;
      }
      .reset-btn {
        background: linear-gradient(90deg, #6c757d, #5a6268);
      }
      .calculate-btn:hover, .reset-btn:hover, .share-btn:hover, .export-btn:hover, .csv-btn:hover {
        background: linear-gradient(90deg, #0056b3, #004085);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.4);
      }
      .reset-btn:hover {
        background: linear-gradient(90deg, #5a6268, #4b5156);
      }
      .calculate-btn:active, .reset-btn:active, .share-btn:active, .export-btn:active, .csv-btn:active {
        transform: scale(0.98);
      }
      .results, .breakdown, .history {
        background: #f8f9fa;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
      }
      .results.loading::before, .breakdown.loading::before, .history.loading::before {
        content: '';
        display: block;
        height: 100px;
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s infinite;
      }
      @keyframes skeleton-loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }
      .results:not(.hidden), .breakdown:not(.hidden), .history:not(.hidden) {
        animation: fadeIn 0.5s ease;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .result-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      .result-item {
        text-align: center;
        padding: 15px;
        background: #fff;
        border-radius: 8px;
        border: 1px solid #dee2e6;
      }
      .result-value {
        font-size: 24px;
        font-weight: bold;
        color: #007bff;
        margin-bottom: 5px;
      }
      .result-label {
        color: #495057; /* –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å */
        font-size: 14px;
      }
      .breakdown h3, .history h3 {
        color: #333;
        margin-bottom: 20px;
        text-align: center;
      }
      .breakdown-item, .history-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #e9ecef;
      }
      .breakdown-item:last-child, .history-item:last-child {
        border-bottom: none;
      }
      .history-item button {
        background: #007bff;
        color: #fff;
        border: none;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
      }
      .history-item button:hover {
        background: #0056b3;
      }
      .info-tips {
        background: #e3f2fd;
        border: 1px solid #bbdefb;
        border-radius: 8px;
        padding: 20px;
        margin-top: 30px;
      }
      .info-tips h3 {
        color: #1976d2;
        margin-bottom: 15px;
      }
      .tip-item {
        margin-bottom: 10px;
        padding-left: 20px;
        position: relative;
        color: #343a40; /* –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å */
      }
      .tip-item:before {
        content: "üí°";
        position: absolute;
        left: 0;
      }
      .disclaimer {
        margin-top: 20px;
        color: #495057; /* –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å */
        font-size: 0.9rem;
        text-align: center;
      }
      #mobile-anchor-ad button {
        background: none;
        border: 0;
        font-size: 16px;
        line-height: 1;
        cursor: pointer;
      }
      @media (max-width: 768px) {
        .input-section {
          grid-template-columns: 1fr;
        }
        .result-grid {
          grid-template-columns: 1fr;
        }
        body {
          padding: 12px;
        }
        .calculate-btn, .reset-btn, .share-btn, .export-btn, .csv-btn {
          width: 100%;
          margin: 10px 0;
        }
        #mobile-anchor-ad {
          bottom: env(safe-area-inset-bottom);
        }
      }
    </style>
  </head>
  <body>
    <!-- –ú–µ–Ω—é -->
    <div id="menuContainer"></div>

    <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
    <div class="breadcrumb">
      <a href="/frontend/tools/index.html">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a> ‚Üí 
      <span>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏</span>
    </div>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã",
          "item": "https://serpmonn.ru/frontend/tools/index.html"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏",
          "item": "https://serpmonn.ru/frontend/tools/logistics/depreciation-calculator.html"
        }
      ]
    }
    </script>

    <div class="ad-top-banner" style="text-align:center;margin:16px 0;">
      <ins class="mrg-tag" 
          style="display:inline-block;"
          data-ad-client="ad-1897960" 
          data-ad-slot="1897960">
      </ins>
    </div>

    <h1>üîß Depreciation calculator –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h1>
    <div class="calculator-container">
      <h2>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h2>
      <div id="error-message" class="error-message hidden" role="alert"></div>
      <div class="input-section">
        <div class="input-group">
          <label for="carBrand">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è</label>
          <input type="text" id="carBrand" list="carBrands" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota" title="–í–≤–µ–¥–∏—Ç–µ –º–∞—Ä–∫—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, Toyota –∏–ª–∏ BMW">
          <datalist id="carBrands">
            <option value="Toyota">
            <option value="Lada">
            <option value="Hyundai">
            <option value="BMW">
            <option value="Mercedes">
          </datalist>
        </div>
        <div class="input-group">
          <label for="carModel">–ú–æ–¥–µ–ª—å</label>
          <input type="text" id="carModel" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Camry" title="–í–≤–µ–¥–∏—Ç–µ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, Camry –∏–ª–∏ X5">
        </div>
        <div class="input-group">
          <label for="carYear">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</label>
          <input type="number" id="carYear" min="1990" max="2025" value="2020" title="–í–≤–µ–¥–∏—Ç–µ –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è (1990‚Äì2025)">
        </div>
        <div class="input-group">
          <label for="initialPrice">–ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)</label>
          <input type="number" id="initialPrice" placeholder="1500000" min="100000" title="–í–≤–µ–¥–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è –≤ —Ä—É–±–ª—è—Ö">
        </div>
        <div class="input-group">
          <label for="currentMileage">–¢–µ–∫—É—â–∏–π –ø—Ä–æ–±–µ–≥ (–∫–º)</label>
          <input type="number" id="currentMileage" placeholder="50000" min="0" title="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–±–µ–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö">
        </div>
        <div class="input-group">
          <label for="usageType">–¢–∏–ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</label>
          <select id="usageType" title="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <option value="personal">–õ–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</option>
            <option value="taxi">–¢–∞–∫—Å–∏</option>
            <option value="commercial">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏</option>
            <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
          </select>
        </div>
        <div class="input-group">
          <label for="fuelType">–¢–∏–ø —Ç–æ–ø–ª–∏–≤–∞</label>
          <select id="fuelType" title="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç–æ–ø–ª–∏–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <option value="petrol">–ë–µ–Ω–∑–∏–Ω</option>
            <option value="diesel">–î–∏–∑–µ–ª—å</option>
            <option value="hybrid">–ì–∏–±—Ä–∏–¥</option>
            <option value="electric">–≠–ª–µ–∫—Ç—Ä–æ</option>
          </select>
        </div>
        <div class="input-group">
          <label for="maintenanceLevel">–£—Ä–æ–≤–µ–Ω—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</label>
          <select id="maintenanceLevel" title="–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <option value="excellent">–û—Ç–ª–∏—á–Ω—ã–π</option>
            <option value="good">–•–æ—Ä–æ—à–∏–π</option>
            <option value="average">–°—Ä–µ–¥–Ω–∏–π</option>
            <option value="poor">–ü–ª–æ—Ö–æ–π</option>
          </select>
        </div>
        <div class="input-group">
          <label for="climateZone">–ö–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞</label>
          <select id="climateZone" title="–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–æ–Ω—É —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏">
            <option value="mild">–£–º–µ—Ä–µ–Ω–Ω–∞—è</option>
            <option value="cold">–•–æ–ª–æ–¥–Ω–∞—è</option>
            <option value="hot">–ñ–∞—Ä–∫–∞—è</option>
            <option value="humid">–í–ª–∞–∂–Ω–∞—è</option>
          </select>
        </div>
        <div class="input-group">
          <label for="region">–†–µ–≥–∏–æ–Ω</label>
          <select id="region" title="–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <option value="central">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π (–ú–æ—Å–∫–≤–∞)</option>
            <option value="north">–°–µ–≤–µ—Ä (–°–ü–±)</option>
            <option value="siberia">–°–∏–±–∏—Ä—å</option>
            <option value="south">–Æ–≥</option>
          </select>
        </div>
        <div class="input-group">
          <label for="currentNewPrice">–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–æ–≤—ã—Ö –∞–Ω–∞–ª–æ–≥–æ–≤ (‚ÇΩ)</label>
          <input type="number" id="currentNewPrice" placeholder="900000" min="100000" title="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –≤ —Ä—É–±–ª—è—Ö">
          <small style="color: #6c757d; font-size: 12px;">–¶–µ–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è —Å–µ–π—á–∞—Å</small>
        </div>
        <div class="input-group">
          <label for="marketGrowth">–†—ã–Ω–æ—á–Ω—ã–π —Ä–æ—Å—Ç —Ü–µ–Ω (%)</label>
          <input type="number" id="marketGrowth" placeholder="40" min="0" max="200" value="40" title="–£–∫–∞–∂–∏—Ç–µ —Ä–æ—Å—Ç —Ü–µ–Ω –Ω–∞ –Ω–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ–∫—É–ø–∫–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö">
          <small style="color: #6c757d; font-size: 12px;">–†–æ—Å—Ç —Ü–µ–Ω –Ω–∞ –Ω–æ–≤—ã–µ –∞–≤—Ç–æ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ–∫—É–ø–∫–∏</small>
        </div>
        <div class="input-group">
          <label for="inflationRate">–ì–æ–¥–æ–≤–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è (%)</label>
          <input type="number" id="inflationRate" placeholder="5" min="0" max="50" value="5" title="–£–∫–∞–∂–∏—Ç–µ —Å—Ä–µ–¥–Ω—é—é –≥–æ–¥–æ–≤—É—é –∏–Ω—Ñ–ª—è—Ü–∏—é –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è">
          <small style="color: #6c757d; font-size: 12px;">–°—Ä–µ–¥–Ω—è—è –∏–Ω—Ñ–ª—è—Ü–∏—è –∑–∞ –≥–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è</small>
        </div>
        <div class="input-group">
          <label for="demandLevel">–°–ø—Ä–æ—Å –Ω–∞ –º–æ–¥–µ–ª—å</label>
          <select id="demandLevel" title="–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ø—Ä–æ—Å–∞ –Ω–∞ –º–æ–¥–µ–ª—å">
            <option value="high">–í—ã—Å–æ–∫–∏–π —Å–ø—Ä–æ—Å</option>
            <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π —Å–ø—Ä–æ—Å</option>
            <option value="low">–ù–∏–∑–∫–∏–π —Å–ø—Ä–æ—Å</option>
          </select>
        </div>
        <div class="input-group">
          <label for="technicalCondition">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</label>
          <select id="technicalCondition" title="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <option value="excellent" selected>–û—Ç–ª–∏—á–Ω–æ–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª)</option>
            <option value="good">–•–æ—Ä–æ—à–µ–µ (–Ω–µ–±–æ–ª—å—à–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã)</option>
            <option value="average">–°—Ä–µ–¥–Ω–µ–µ (—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª—Å—è)</option>
            <option value="poor">–ü–ª–æ—Ö–æ–µ (–∞–≤–∞—Ä–∏–π–Ω—ã–π)</option>
          </select>
          <small style="color: #6c757d; font-size: 12px;">–£—á–∏—Ç—ã–≤–∞–µ—Ç –∞–≤–∞—Ä–∏–∏, —Ä–µ–º–æ–Ω—Ç—ã, –ø–µ—Ä–µ–∫—Ä–∞—Å–∫—É</small>
        </div>
      </div>
      <div style="text-align: center;">
        <button class="calculate-btn" onclick="calculateDepreciation()" aria-label="–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—é –∞–≤—Ç–æ–º–æ–±–∏–ª—è">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—é</button>
        <button class="reset-btn" onclick="resetForm()" aria-label="–°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <button class="share-btn" onclick="copyShareLink()" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–∞—Å—á—ë—Ç">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
        <button class="export-btn" onclick="exportToPDF()" aria-label="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ PDF">–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</button>
        <button class="csv-btn" onclick="exportToCSV()" aria-label="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV">–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
      </div>
      <div id="results" class="results hidden" aria-live="polite">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–∞</h3>
        <canvas id="depreciationChart" style="max-height: 300px; margin-top: 20px;"></canvas>
        <div class="result-grid">
          <div class="result-item">
            <div class="result-value" id="currentValue">0 ‚ÇΩ</div>
            <div class="result-label">–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
          </div>
          <div class="result-item">
            <div class="result-value" id="totalDepreciation">0 ‚ÇΩ</div>
            <div class="result-label">–û–±—â–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è</div>
          </div>
          <div class="result-item">
            <div class="result-value" id="depreciationPercent">0%</div>
            <div class="result-label">–ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–Ω–æ—Å–∞</div>
          </div>
          <div class="result-item">
            <div class="result-value" id="monthlyDepreciation">0 ‚ÇΩ/–º–µ—Å</div>
            <div class="result-label">–ú–µ—Å—è—á–Ω–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è</div>
          </div>
        </div>
      </div>
    </div>
    <div id="breakdown" class="breakdown hidden" aria-live="polite">
      <h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏</h3>
      <div id="breakdownList"></div>
    </div>
    <div id="history" class="history hidden" aria-live="polite">
      <h3>–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤</h3>
      <ul id="historyList"></ul>
    </div>
    <div class="info-tips">
      <h3>üí° –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
      <div class="tip-item">–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–±–µ–≥–∞, –≤—Ä–µ–º–µ–Ω–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∏ —É—Å–ª–æ–≤–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</div>
      <div class="tip-item">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∏–∑–Ω–æ—Å –≤ 1.5-2 —Ä–∞–∑–∞</div>
      <div class="tip-item">–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –¢–û –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∑–∞–º–µ–¥–ª—è—é—Ç –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—é</div>
      <div class="tip-item">–ö–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É—Å–ª–æ–≤–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ –∏–∑–Ω–æ—Å –∫—É–∑–æ–≤–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏</div>
      <div class="tip-item">–ì–∏–±—Ä–∏–¥–Ω—ã–µ –∏ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –∏–º–µ—é—Ç –º–µ–Ω—å—à—É—é –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—é –¥–≤–∏–≥–∞—Ç–µ–ª—è, –Ω–æ –±–∞—Ç–∞—Ä–µ—è –∏–∑–Ω–∞—à–∏–≤–∞–µ—Ç—Å—è –æ—Ç –ø—Ä–æ–±–µ–≥–∞</div>
      <div class="tip-item"><strong>–†—ã–Ω–æ—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:</strong> –£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ä–æ—Å—Ç —Ü–µ–Ω –Ω–∞ –Ω–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –∏ —Å–ø—Ä–æ—Å –Ω–∞ –≤–∞—à—É –º–æ–¥–µ–ª—å</div>
      <div class="tip-item"><strong>–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –¶–µ–Ω—ã –º–æ–≥—É—Ç —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö</div>
      <div class="tip-item"><strong>–ò–Ω—Ñ–ª—è—Ü–∏—è:</strong> –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –≥–æ–¥–æ–≤—É—é –∏–Ω—Ñ–ª—è—Ü–∏—é –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏</div>
    </div>
    <div id="mobile-anchor-ad" class="mobile-anchor-ad" style="position:fixed;left:0;right:0;bottom:0;display:none;justify-content:center;z-index:2147483000;padding-bottom: env(safe-area-inset-bottom);pointer-events:none;">
      <div style="pointer-events:auto;background:rgba(255,255,255,.98);box-shadow:0 -2px 10px rgba(0,0,0,.15);border-radius:8px 8px 0 0;padding:6px 10px;display:flex;gap:8px;align-items:center;">
        <button type="button" aria-label="–ó–∞–∫—Ä—ã—Ç—å —Ä–µ–∫–ª–∞–º—É">–ó–∞–∫—Ä—ã—Ç—å</button>
        <ins class="mrg-tag" 
            style="display:inline-block;width:320px;height:50px" 
            data-ad-client="ad-1898031"
            data-ad-slot="1898031">
        </ins>
      </div>
    </div>
    <script type="module" src="/frontend/scripts/menu-loader.js" defer></script>
    <script>
      const calcCache = new Map();
      const CACHE_TTL = 60 * 60 * 1000; // 1 —á–∞—Å
      let adScriptLoaded = false;
      let chartInstance = null;

      async function loadChartJs() {
        if (!window.Chart) {
          await import('https://cdn.jsdelivr.net/npm/chart.js');
        }
      }

      async function loadJsPDF() {
        if (!window.jspdf) {
          await import('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js');
        }
      }

      function loadAdScript() {
        if (!adScriptLoaded) {
          const script = document.createElement('script');
          script.src = 'https://ad.mail.ru/static/ads-async.js';
          script.async = true;
          script.onload = () => { adScriptLoaded = true; };
          document.head.appendChild(script);
        }
      }

      const adObserver = new IntersectionObserver(
        (entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              loadAdScript();
              (MRGtag = window.MRGtag || []).push({});
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.1 }
      );

      document.querySelectorAll('.ad-top-banner, #mobile-anchor-ad').forEach(banner => {
        const ad = banner.querySelector('.mrg-tag');
        if (ad) adObserver.observe(ad);
      });

      function debounce(func, wait) {
        let timeout;
        return function (...args) {
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(this, args), wait);
        };
      }

      function sanitizeInput(input) {
        return input.replace(/[<>&"']/g, '');
      }

      function resetForm() {
        document.querySelector('.input-section').closest('form')?.reset();
        document.getElementById('results').classList.add('hidden');
        document.getElementById('breakdown').classList.add('hidden');
        document.getElementById('history').classList.add('hidden');
        document.getElementById('error-message').classList.add('hidden');
        document.querySelector('meta[name="description"]').content = '–†–∞—Å—á—ë—Ç –∏–∑–Ω–æ—Å–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–æ –ø—Ä–æ–±–µ–≥—É, –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—Å–ª–æ–≤–∏—è–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏';
        document.title = '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è ‚Äî –õ–æ–≥–∏—Å—Ç–∏–∫–∞ Serpmonn';
        window.history.replaceState({}, '', window.location.pathname);
        document.querySelectorAll('#results > div:not(.result-grid), #results > canvas').forEach(el => el.remove());
        if (chartInstance) {
          chartInstance.destroy();
          chartInstance = null;
        }
        document.getElementById('carBrand').focus();
      }

      function copyShareLink() {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        }).catch(() => {
          alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏');
        });
      }

      function exportToPDF() {
        loadJsPDF().then(() => {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();
          doc.setFontSize(16);
          doc.text('–†–∞—Å—á—ë—Ç –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è', 10, 10);
          doc.setFontSize(12);
          doc.text(`–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${document.getElementById('currentValue').textContent}`, 10, 20);
          doc.text(`–û–±—â–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è: ${document.getElementById('totalDepreciation').textContent}`, 10, 30);
          doc.text(`–ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–Ω–æ—Å–∞: ${document.getElementById('depreciationPercent').textContent}`, 10, 40);
          doc.text(`–ú–µ—Å—è—á–Ω–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è: ${document.getElementById('monthlyDepreciation').textContent}`, 10, 50);
          doc.text('–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–æ—Ç —Ä–∞—Å—á—ë—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–º. –î–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –æ—Ü–µ–Ω—â–∏–∫—É.', 10, 60);
          doc.save('depreciation_report.pdf');
        });
      }

      function exportToCSV() {
        const headers = ['–ú–∞—Ä–∫–∞', '–ú–æ–¥–µ–ª—å', '–ì–æ–¥', '–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)', '–û–±—â–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è (‚ÇΩ)', '–ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–Ω–æ—Å–∞ (%)', '–ú–µ—Å—è—á–Ω–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è (‚ÇΩ)'];
        const data = [
          [
            document.getElementById('carBrand').value,
            document.getElementById('carModel').value,
            document.getElementById('carYear').value,
            document.getElementById('currentValue').textContent,
            document.getElementById('totalDepreciation').textContent,
            document.getElementById('depreciationPercent').textContent,
            document.getElementById('monthlyDepreciation').textContent
          ]
        ];
        const csv = [headers.join(','), ...data.map(row => row.join(','))].join('\n');
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'depreciation_report.csv';
        link.click();
      }

      function calculateDepreciation() {
        const errorMessage = document.getElementById('error-message');
        errorMessage.classList.add('hidden');

        const inputs = {
          carBrand: sanitizeInput(document.getElementById('carBrand').value),
          carModel: sanitizeInput(document.getElementById('carModel').value),
          carYear: parseInt(document.getElementById('carYear').value),
          initialPrice: parseFloat(document.getElementById('initialPrice').value),
          currentMileage: parseFloat(document.getElementById('currentMileage').value),
          usageType: document.getElementById('usageType').value,
          fuelType: document.getElementById('fuelType').value,
          maintenanceLevel: document.getElementById('maintenanceLevel').value,
          climateZone: document.getElementById('climateZone').value,
          region: document.getElementById('region').value,
          currentNewPrice: parseFloat(document.getElementById('currentNewPrice').value),
          marketGrowth: parseFloat(document.getElementById('marketGrowth').value),
          inflationRate: parseFloat(document.getElementById('inflationRate').value),
          demandLevel: document.getElementById('demandLevel').value,
          technicalCondition: document.getElementById('technicalCondition').value
        };

        if (!inputs.initialPrice || !inputs.currentMileage || isNaN(inputs.carYear)) {
          errorMessage.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞, –Ω–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –ø—Ä–æ–±–µ–≥';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }
        if (inputs.initialPrice < 100000) {
          errorMessage.textContent = '–ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 100,000 ‚ÇΩ';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }
        if (inputs.currentMileage < 0) {
          errorMessage.textContent = '–ü—Ä–æ–±–µ–≥ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }
        if (inputs.currentMileage > 500000) {
          errorMessage.textContent = '–ü—Ä–æ–±–µ–≥ > 500,000 –∫–º - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ, –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω–æ–π';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
        }
        if (inputs.currentNewPrice && inputs.currentNewPrice < 100000) {
          errorMessage.textContent = '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–æ–≤—ã—Ö –∞–Ω–∞–ª–æ–≥–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 100,000 ‚ÇΩ';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }
        if (inputs.marketGrowth && (inputs.marketGrowth < 0 || inputs.marketGrowth > 200)) {
          errorMessage.textContent = '–†—ã–Ω–æ—á–Ω—ã–π —Ä–æ—Å—Ç —Ü–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 0 –¥–æ 200%';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }
        if (inputs.inflationRate && (inputs.inflationRate < 0 || inputs.inflationRate > 50)) {
          errorMessage.textContent = '–ì–æ–¥–æ–≤–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 0 –¥–æ 50%';
          errorMessage.classList.remove('hidden');
          errorMessage.focus();
          return;
        }

        const cacheKey = JSON.stringify(inputs);
        if (calcCache.has(cacheKey)) {
          const { currentValue, totalDepreciation, depreciationPercent, monthlyDepreciation, totalDepreciationRate, breakdown } = calcCache.get(cacheKey);
          displayResults(currentValue, totalDepreciation, depreciationPercent, monthlyDepreciation, totalDepreciationRate, inputs);
          document.getElementById('breakdownList').innerHTML = breakdown;
          document.getElementById('results').classList.remove('hidden');
          document.getElementById('breakdown').classList.remove('hidden');
          return;
        }

        if (calcCache.size > 10) {
          calcCache.delete(calcCache.keys().next().value);
        }

        document.getElementById('results').classList.add('loading');
        document.getElementById('breakdown').classList.add('loading');
        document.querySelectorAll('#results > div:not(.result-grid), #results > canvas').forEach(el => el.remove());

        setTimeout(() => {
          const { carYear, initialPrice, currentMileage, usageType, fuelType, maintenanceLevel, climateZone, region, currentNewPrice, marketGrowth, inflationRate, demandLevel, technicalCondition } = inputs;

          let baseDepreciation = 0;
          const currentYear = new Date().getFullYear();
          const ageInYears = currentYear - carYear;
          const depreciationRate = 0.2; // –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ 20% –≤ –≥–æ–¥ (—Å—Ä–µ–¥–Ω—è—è –ø–æ —Ä—ã–Ω–∫—É 2025)
          for (let i = 1; i <= ageInYears; i++) {
            baseDepreciation += (1 - baseDepreciation) * depreciationRate;
          }
          baseDepreciation = Math.min(baseDepreciation, 0.6);

          let mileageDepreciation = 0;
          if (currentMileage <= 50000) {
            mileageDepreciation = currentMileage / 50000 * 0.1;
          } else if (currentMileage <= 150000) {
            mileageDepreciation = 0.1 + (currentMileage - 50000) / 100000 * 0.15;
          } else if (currentMileage <= 300000) {
            mileageDepreciation = 0.25 + (currentMileage - 150000) / 150000 * 0.2;
          } else {
            mileageDepreciation = 0.45 + (currentMileage - 300000) / 100000 * 0.1;
          }

          let batteryDepreciation = 0;
          if (fuelType === 'electric') {
            batteryDepreciation = Math.min(currentMileage / 200000 * 0.2, 0.2); // 20% –∏–∑–Ω–æ—Å –±–∞—Ç–∞—Ä–µ–∏ –ø—Ä–∏ 200,000 –∫–º
            baseDepreciation += batteryDepreciation;
          }

          const usageMultipliers = {
            'personal': 1.0, 'taxi': 1.4, 'commercial': 1.3, 'delivery': 1.2
          };
          const fuelMultipliers = {
            'petrol': 1.0, 'diesel': 0.9, 'hybrid': 0.7, 'electric': 0.6
          };
          const maintenanceMultipliers = {
            'excellent': 0.7, 'good': 0.85, 'average': 1.0, 'poor': 1.2
          };
          const climateMultipliers = {
            'mild': 1.0, 'cold': 1.15, 'hot': 1.1, 'humid': 1.2
          };
          const regionMultipliers = {
            'central': 1.1, 'north': 1.05, 'siberia': 1.15, 'south': 1.0
          };
          const demandMultipliers = {
            'high': 1.2, 'medium': 1.0, 'low': 0.8
          };
          const technicalConditionMultipliers = {
            'excellent': 1.0, 'good': 0.9, 'average': 0.75, 'poor': 0.5
          };

          let adjustedInitialPrice = initialPrice;
          if (inflationRate) {
            for (let i = 1; i <= ageInYears; i++) {
              adjustedInitialPrice *= (1 + inflationRate / 100);
            }
          }

          const baseDepreciationRate = Math.min(baseDepreciation + mileageDepreciation, 0.6);
          const totalDepreciationRate = Math.min(
            baseDepreciationRate * 
            usageMultipliers[usageType] * 
            fuelMultipliers[fuelType] * 
            maintenanceMultipliers[maintenanceLevel] * 
            climateMultipliers[climateZone] * 
            regionMultipliers[region] *
            demandMultipliers[demandLevel] * 
            technicalConditionMultipliers[technicalCondition],
            0.8
          );

          const totalDepreciation = adjustedInitialPrice * totalDepreciationRate;
          let currentValue = adjustedInitialPrice - totalDepreciation;

          if (currentNewPrice) {
            const marketRatio = currentNewPrice / initialPrice;
            const ageFactor = Math.max(0.3, 1 - (ageInYears * 0.05));
            currentValue = currentValue * (1 + (marketRatio - 1) * ageFactor);
          } else if (marketGrowth) {
            const ageFactor = Math.max(0.3, 1 - (ageInYears * 0.05));
            currentValue = currentValue * (1 + (marketGrowth / 100) * ageFactor);
          }

          const depreciationPercent = (totalDepreciationRate * 100).toFixed(1);
          const monthlyDepreciation = totalDepreciation / (ageInYears * 12 || 1);

          displayResults(currentValue, totalDepreciation, depreciationPercent, monthlyDepreciation, totalDepreciationRate, inputs, adjustedInitialPrice, batteryDepreciation);
          const breakdown = showBreakdown(adjustedInitialPrice, baseDepreciation, mileageDepreciation, batteryDepreciation, usageType, fuelType, maintenanceLevel, climateZone, region, currentNewPrice, marketGrowth, inflationRate, demandLevel, technicalCondition, baseDepreciationRate, totalDepreciationRate, totalDepreciation, currentValue, usageMultipliers, fuelMultipliers, maintenanceMultipliers, climateMultipliers, regionMultipliers, demandMultipliers, technicalConditionMultipliers);

          calcCache.set(cacheKey, { 
            currentValue, 
            totalDepreciation, 
            depreciationPercent, 
            monthlyDepreciation, 
            totalDepreciationRate, 
            breakdown, 
            timestamp: Date.now() 
          });

          for (const [key, value] of calcCache) {
            if (Date.now() - value.timestamp > CACHE_TTL) {
              calcCache.delete(key);
            }
          }

          try {
            const history = JSON.parse(localStorage.getItem('depreciationHistory') || '[]');
            history.unshift({ ...inputs, timestamp: new Date().toISOString(), result: { currentValue, totalDepreciation, depreciationPercent, monthlyDepreciation } });
            if (history.length > 5) history.pop();
            const historySize = JSON.stringify(history).length;
            if (historySize < 5 * 1024 * 1024) {
              localStorage.setItem('depreciationHistory', JSON.stringify(history));
            }
          } catch (e) {
            console.warn('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏:', e);
          }

          document.getElementById('results').classList.remove('loading', 'hidden');
          document.getElementById('breakdown').classList.remove('loading', 'hidden');
        }, 300);
      }

      function displayResults(currentValue, totalDepreciation, depreciationPercent, monthlyDepreciation, totalDepreciationRate, inputs, adjustedInitialPrice, batteryDepreciation) {
        document.getElementById('currentValue').textContent = Math.round(currentValue).toLocaleString() + ' ‚ÇΩ';
        document.getElementById('totalDepreciation').textContent = Math.round(totalDepreciation).toLocaleString() + ' ‚ÇΩ';
        document.getElementById('depreciationPercent').textContent = depreciationPercent + '%';
        document.getElementById('monthlyDepreciation').textContent = Math.round(monthlyDepreciation).toLocaleString() + ' ‚ÇΩ/–º–µ—Å';

        if (inputs.carBrand && inputs.carModel) {
          document.querySelector('meta[name="description"]').content = `–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—é ${inputs.carBrand} ${inputs.carModel} (${inputs.carYear}) —Å —É—á—ë—Ç–æ–º –ø—Ä–æ–±–µ–≥–∞ –∏ —É—Å–ª–æ–≤–∏–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏`;
          document.title = `–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è ${inputs.carBrand} ${inputs.carModel} (${inputs.carYear}) ‚Äî Serpmonn`;
        }

        const urlParams = new URLSearchParams();
        Object.entries(inputs).forEach(([key, value]) => {
          if (value) urlParams.set(key, value);
        });
        window.history.replaceState({}, '', `${window.location.pathname}?${urlParams}`);

        try {
          localStorage.setItem('lastDepreciation', JSON.stringify(inputs));
        } catch (e) {}

        const currentYear = new Date().getFullYear();
        const ageInYears = currentYear - inputs.carYear;
        const chartData = [];
        const depreciationRate = 0.2;
        let accumulatedDepreciation = 0;
        for (let year = 0; year <= ageInYears; year++) {
          accumulatedDepreciation += (1 - accumulatedDepreciation) * depreciationRate;
          const yearValue = inputs.initialPrice * (1 - Math.min(accumulatedDepreciation, 0.6));
          chartData.push({ x: inputs.carYear + year, y: Math.round(yearValue) });
        }
        const averageMileagePerYear = 15000;
        let forecastMileage = inputs.currentMileage;
        for (let year = 1; year <= 5; year++) {
          accumulatedDepreciation += (1 - accumulatedDepreciation) * depreciationRate;
          forecastMileage += averageMileagePerYear;
          let mileageDepreciation = 0;
          if (forecastMileage <= 50000) {
            mileageDepreciation = forecastMileage / 50000 * 0.1;
          } else if (forecastMileage <= 150000) {
            mileageDepreciation = 0.1 + (forecastMileage - 50000) / 100000 * 0.15;
          } else if (forecastMileage <= 300000) {
            mileageDepreciation = 0.25 + (forecastMileage - 150000) / 150000 * 0.2;
          } else {
            mileageDepreciation = 0.45 + (forecastMileage - 300000) / 100000 * 0.1;
          }
          if (inputs.fuelType === 'electric') {
            mileageDepreciation += Math.min(forecastMileage / 200000 * 0.2, 0.2);
          }
          const forecastDepreciation = Math.min(accumulatedDepreciation + mileageDepreciation, 0.6);
          const yearValue = inputs.initialPrice * (1 - forecastDepreciation);
          chartData.push({ x: currentYear + year, y: Math.round(yearValue), forecast: true });
        }

        loadChartJs().then(() => {
          if (chartInstance) {
            chartInstance.destroy();
          }
          const chartCanvas = document.createElement('canvas');
          chartCanvas.id = 'depreciationChart';
          chartCanvas.style.maxHeight = '300px';
          chartCanvas.style.marginTop = '20px';
          document.getElementById('results').prepend(chartCanvas);

          chartInstance = new Chart(chartCanvas, {
            type: 'line',
            data: {
              datasets: [
                {
                  label: '–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)',
                  data: chartData.filter(d => !d.forecast),
                  borderColor: '#007bff',
                  backgroundColor: 'rgba(0, 123, 255, 0.1)',
                  fill: true,
                  tension: 0.4
                },
                {
                  label: '–ü—Ä–æ–≥–Ω–æ–∑ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (‚ÇΩ)',
                  data: chartData.filter(d => d.forecast),
                  borderColor: '#28a745',
                  backgroundColor: 'rgba(40, 167, 69, 0.1)',
                  fill: true,
                  tension: 0.4,
                  borderDash: [5, 5]
                }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                x: { title: { display: true, text: '–ì–æ–¥' } },
                y: { 
                  title: { display: true, text: '–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)' },
                  ticks: {
                    callback: function(value) {
                      return value.toLocaleString('ru-RU') + ' ‚ÇΩ';
                    }
                  }
                }
              },
              plugins: { legend: { display: true } }
            }
          });
        });

        if (totalDepreciationRate > 0.7) {
          const warning = document.createElement('div');
          warning.style.cssText = 'background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; margin-top: 20px; color: #856404;';
          warning.innerHTML = `
            <strong>‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è:</strong><br>
            ‚Ä¢ –ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–Ω–æ—Å–∞: ${depreciationPercent}%<br>
            ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ<br>
            ‚Ä¢ –ü—Ä–∏ —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ø–ª–æ—Ö–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
          `;
          document.getElementById('results').appendChild(warning);
        }

        if (inputs.currentNewPrice || inputs.marketGrowth || inputs.inflationRate) {
          const explanation = document.createElement('div');
          explanation.style.cssText = 'background: #e8f5e8; border: 1px solid #c3e6c3; border-radius: 8px; padding: 15px; margin-top: 20px; color: #155724;';
          const ageFactor = Math.max(0.3, 1 - (ageInYears * 0.05));
          let explanationHTML = '<strong>üí° –†—ã–Ω–æ—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞:</strong><br>';
          explanationHTML += `‚Ä¢ –ù–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: ${Math.round(inputs.initialPrice).toLocaleString()} ‚ÇΩ<br>`;
          if (inputs.inflationRate) {
            explanationHTML += `‚Ä¢ –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (—Å —É—á—ë—Ç–æ–º –∏–Ω—Ñ–ª—è—Ü–∏–∏ ${inputs.inflationRate}%): ${Math.round(adjustedInitialPrice).toLocaleString()} ‚ÇΩ<br>`;
          }
          if (inputs.currentNewPrice) {
            explanationHTML += `
              ‚Ä¢ –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–æ–≤—ã—Ö –∞–Ω–∞–ª–æ–≥–æ–≤: ${Math.round(inputs.currentNewPrice).toLocaleString()} ‚ÇΩ<br>
              ‚Ä¢ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ—Å—Ç–∞: ${(inputs.currentNewPrice / inputs.initialPrice).toFixed(2)}x<br>
            `;
          } else if (inputs.marketGrowth) {
            explanationHTML += `‚Ä¢ –†–æ—Å—Ç —Ü–µ–Ω: +${inputs.marketGrowth}%<br>`;
          }
          explanationHTML += `
            ‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä: ${(ageFactor * 100).toFixed(0)}% (–≤–æ–∑—Ä–∞—Å—Ç ${ageInYears} –ª–µ—Ç)<br>
            ‚Ä¢ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å —É—á—ë—Ç–æ–º —Ä—ã–Ω–∫–∞: ${Math.round(currentValue).toLocaleString()} ‚ÇΩ
          `;
          explanation.innerHTML = explanationHTML;
          document.getElementById('results').appendChild(explanation);
        }

        const disclaimer = document.createElement('div');
        disclaimer.className = 'disclaimer';
        disclaimer.innerHTML = '<p>–≠—Ç–æ—Ç —Ä–∞—Å—á—ë—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–º –∏ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –æ—Ü–µ–Ω—â–∏–∫—É.</p>';
        document.getElementById('results').appendChild(disclaimer);
      }

      function showBreakdown(initialPrice, baseDepreciation, mileageDepreciation, batteryDepreciation, usageType, fuelType, maintenanceLevel, climateZone, region, currentNewPrice, marketGrowth, inflationRate, demandLevel, technicalCondition, baseDepreciationRate, totalDepreciationRate, totalDepreciation, currentValue, usageMultipliers, fuelMultipliers, maintenanceMultipliers, climateMultipliers, regionMultipliers, demandMultipliers, technicalConditionMultipliers) {
        const breakdownList = document.getElementById('breakdownList');
        const depreciationPercent = (totalDepreciationRate * 100).toFixed(1);
        const usageNames = {
          'personal': '–õ–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ',
          'taxi': '–¢–∞–∫—Å–∏',
          'commercial': '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏',
          'delivery': '–î–æ—Å—Ç–∞–≤–∫–∞'
        };
        const fuelNames = {
          'petrol': '–ë–µ–Ω–∑–∏–Ω',
          'diesel': '–î–∏–∑–µ–ª—å',
          'hybrid': '–ì–∏–±—Ä–∏–¥',
          'electric': '–≠–ª–µ–∫—Ç—Ä–æ'
        };
        const maintenanceNames = {
          'excellent': '–û—Ç–ª–∏—á–Ω—ã–π',
          'good': '–•–æ—Ä–æ—à–∏–π',
          'average': '–°—Ä–µ–¥–Ω–∏–π',
          'poor': '–ü–ª–æ—Ö–æ–π'
        };
        const climateNames = {
          'mild': '–£–º–µ—Ä–µ–Ω–Ω–∞—è',
          'cold': '–•–æ–ª–æ–¥–Ω–∞—è',
          'hot': '–ñ–∞—Ä–∫–∞—è',
          'humid': '–í–ª–∞–∂–Ω–∞—è'
        };
        const regionNames = {
          'central': '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π (–ú–æ—Å–∫–≤–∞)',
          'north': '–°–µ–≤–µ—Ä (–°–ü–±)',
          'siberia': '–°–∏–±–∏—Ä—å',
          'south': '–Æ–≥'
        };
        const demandNames = {
          'high': '–í—ã—Å–æ–∫–∏–π —Å–ø—Ä–æ—Å',
          'medium': '–°—Ä–µ–¥–Ω–∏–π —Å–ø—Ä–æ—Å',
          'low': '–ù–∏–∑–∫–∏–π —Å–ø—Ä–æ—Å'
        };
        const technicalConditionNames = {
          'excellent': '–û—Ç–ª–∏—á–Ω–æ–µ',
          'good': '–•–æ—Ä–æ—à–µ–µ',
          'average': '–°—Ä–µ–¥–Ω–µ–µ',
          'poor': '–ü–ª–æ—Ö–æ–µ'
        };
        let displayMarketPrice = initialPrice;
        if (currentNewPrice) {
          displayMarketPrice = currentNewPrice;
        } else if (marketGrowth) {
          displayMarketPrice = initialPrice * (1 + marketGrowth / 100);
        }
        let breakdownHTML = `
          <div class="breakdown-item">
            <span>–ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
            <span>${Math.round(initialPrice).toLocaleString()} ‚ÇΩ</span>
          </div>
        `;
        if (inflationRate) {
          breakdownHTML += `
            <div class="breakdown-item">
              <span>–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (–∏–Ω—Ñ–ª—è—Ü–∏—è ${inflationRate}%)</span>
              <span>${Math.round(initialPrice).toLocaleString()} ‚ÇΩ</span>
            </div>
          `;
        }
        breakdownHTML += `
          <div class="breakdown-item">
            <span>–†—ã–Ω–æ—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞</span>
            <span>${Math.round(displayMarketPrice).toLocaleString()} ‚ÇΩ</span>
          </div>
          <div class="breakdown-item">
            <span>–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏</span>
            <span>${(baseDepreciation * 100).toFixed(1)}%</span>
          </div>
          <div class="breakdown-item">
            <span>–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –ø–æ –ø—Ä–æ–±–µ–≥—É</span>
            <span>${(mileageDepreciation * 100).toFixed(1)}%</span>
          </div>
        `;
        if (batteryDepreciation > 0) {
          breakdownHTML += `
            <div class="breakdown-item">
              <span>–ò–∑–Ω–æ—Å –±–∞—Ç–∞—Ä–µ–∏ (—ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—å)</span>
              <span>${(batteryDepreciation * 100).toFixed(1)}%</span>
            </div>
          `;
        }
        breakdownHTML += `
          <div class="breakdown-item">
            <span>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –±–∞–∑–æ–≤–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è</span>
            <span>${(baseDepreciationRate * 100).toFixed(1)}% (–º–∞–∫—Å. 60%)</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (${usageNames[usageType]})</span>
            <span>${usageMultipliers[usageType]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ–ø–ª–∏–≤–∞ (${fuelNames[fuelType]})</span>
            <span>${fuelMultipliers[fuelType]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (${maintenanceNames[maintenanceLevel]})</span>
            <span>${maintenanceMultipliers[maintenanceLevel]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–ª–∏–º–∞—Ç–∞ (${climateNames[climateZone]})</span>
            <span>${climateMultipliers[climateZone]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥–∏–æ–Ω–∞ (${regionNames[region]})</span>
            <span>${regionMultipliers[region]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–ø—Ä–æ—Å–∞ (${demandNames[demandLevel]})</span>
            <span>${demandMultipliers[demandLevel]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (${technicalConditionNames[technicalCondition]})</span>
            <span>${technicalConditionMultipliers[technicalCondition]}x</span>
          </div>
          <div class="breakdown-item">
            <span>–ò—Ç–æ–≥–æ–≤–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è</span>
            <span>${depreciationPercent}% (–º–∞–∫—Å. 80%)</span>
          </div>
          <div class="breakdown-item">
            <span>–°—É–º–º–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏</span>
            <span>${Math.round(totalDepreciation).toLocaleString()} ‚ÇΩ</span>
          </div>
          <div class="breakdown-item">
            <span>–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
            <span>${Math.round(currentValue).toLocaleString()} ‚ÇΩ</span>
          </div>
        `;
        breakdownList.innerHTML = breakdownHTML;
        return breakdownHTML;
      }

      function loadHistory(index) {
        const history = JSON.parse(localStorage.getItem('depreciationHistory') || '[]');
        const entry = history[index];
        Object.entries(entry).forEach(([key, value]) => {
          if (document.getElementById(key)) document.getElementById(key).value = value;
        });
        calculateDepreciation();
      }

      document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        ['carBrand', 'carModel', 'carYear', 'initialPrice', 'currentMileage', 'usageType', 'fuelType', 'maintenanceLevel', 'climateZone', 'region', 'currentNewPrice', 'marketGrowth', 'inflationRate', 'demandLevel', 'technicalCondition'].forEach(id => {
          const value = urlParams.get(id);
          if (value) document.getElementById(id).value = value;
        });

        try {
          const lastDepreciation = JSON.parse(localStorage.getItem('lastDepreciation'));
          if (lastDepreciation) {
            Object.entries(lastDepreciation).forEach(([key, value]) => {
              if (document.getElementById(key)) document.getElementById(key).value = value;
            });
          }
        } catch (e) {}

        try {
          const history = JSON.parse(localStorage.getItem('depreciationHistory') || '[]');
          if (history.length > 0) {
            document.getElementById('history').classList.remove('hidden');
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = history.map((entry, index) => `
              <li class="history-item">
                ${entry.carBrand} ${entry.carModel} (${entry.carYear}) - ${new Date(entry.timestamp).toLocaleString()}: 
                ${Math.round(entry.result.currentValue).toLocaleString()} ‚ÇΩ
                <button onclick="loadHistory(${index})">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
              </li>
            `).join('');
          }
        } catch (e) {}

        if (urlParams.size > 0 || localStorage.getItem('lastDepreciation')) {
          calculateDepreciation();
        }

        document.querySelectorAll('.ad-top-banner, #mobile-anchor-ad').forEach(banner => {
          const ad = banner.querySelector('.mrg-tag');
          if (!ad) return;
          const mutationObserver = new MutationObserver(() => {
            let attempts = 0;
            const maxAttempts = 5;
            const interval = setInterval(() => {
              if (!ad.hasChildNodes() || ad.innerHTML.trim() === '') {
                if (attempts >= maxAttempts) {
                  banner.style.display = 'none';
                  clearInterval(interval);
                  setTimeout(() => {
                    if (!ad.hasChildNodes() || ad.innerHTML.trim() === '') {
                      (MRGtag = window.MRGtag || []).push({});
                    }
                  }, 5000);
                }
              } else {
                clearInterval(interval);
              }
              attempts++;
            }, 1000);
          });
          mutationObserver.observe(ad, { childList: true, subtree: true });
        });

        if (localStorage.getItem('anchor_closed') !== '1' && window.innerWidth <= 768) {
          document.getElementById('mobile-anchor-ad').style.display = 'flex';
        }

        document.querySelectorAll('.input-section input, .input-section select').forEach(input => {
          input.addEventListener('input', debounce(calculateDepreciation, 500));
        });
      });
    </script>
      <script src="/frontend/scripts/mobile-enhancements.js" defer></script>
</body>
</html>
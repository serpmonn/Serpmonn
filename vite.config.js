import { defineConfig } from 'vite'                                                                     // Импорт функции defineConfig из Vite для создания конфигурации

export default defineConfig({                                                                           // Экспорт конфигурации Vite по умолчанию
  server: {                                                                                             // Конфигурация сервера разработки
    port: 5173,                                                                                         // Порт, на котором будет запущен сервер разработки Vite
    open: '/frontend/main.html',                                                                        // Автоматическое открытие браузера на главной странице при запуске
    cors: true,                                                                                         // Включение CORS (Cross-Origin Resource Sharing) для всех источников
    hmr: {                                                                                              // Настройки Hot Module Replacement (горячей замены модулей)
      overlay: false                                                                                    // Отключение оверлея с ошибками поверх страницы при HMR
    },
    
    // PROXY ДЛЯ ВСЕХ БЭКЕНД СЕРВЕРОВ
    proxy: {                                                                                            // Настройки прокси-сервера для перенаправления API запросов
      // Аутентификация и основные API endpoints
      '/auth': {                                                                                        // Прокси для всех запросов начинающихся с /auth (регистрация, вход)
        target: 'http://localhost:5000',                                                                // Целевой сервер - основной бэкенд на порту 5000
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // Основной сервер (profiles, likes, analytics, promocodes и т.д.)
      '/api': {                                                                                         // Прокси для всех запросов начинающихся с /api
        target: 'http://localhost:5000',                                                                // Целевой сервер - основной бэкенд на порту 5000
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // Новости
      '/news': {                                                                                        // Прокси для всех запросов начинающихся с /news
        target: 'http://localhost:4000',                                                                // Целевой сервер - сервер новостей на порту 4000
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // Leaderboard (игры)
      '/games': {                                                                                       // Прокси для всех запросов начинающихся с /games
        target: 'http://localhost:3000',                                                                // Целевой сервер - сервер лидерборда на порту 3000
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // X-Car игра
      '/xcar': {                                                                                        // Прокси для всех запросов начинающихся с /xcar
        target: 'http://localhost:5500',                                                                // Целевой сервер - сервер X-Car игры на порту 5500
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // Onnmail (почтовый сервис)
      '/onnmail': {                                                                                     // Прокси для всех запросов начинающихся с /onnmail
        target: 'http://localhost:6000',                                                                // Целевой сервер - сервер почты на порту 6000
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      },
      
      // Password reset (сброс пароля)
      '/password-reset': {                                                                              // Прокси для всех запросов начинающихся с /password-reset
        target: 'http://localhost:6500',                                                                // Целевой сервер - сервер сброса пароля на порту 6500
        changeOrigin: true                                                                              // Изменение заголовка Origin для обхода CORS ограничений
      }
    }
  },
  
  root: '.',                                                                                            // Корневая директория проекта (текущая папка где находится vite.config.js)
  appType: 'mpa',                                                                                       // Тип приложения - Multi-Page Application (многостраничное приложение)
  
  css: {                                                                                                // Конфигурация обработки CSS
    devSourcemap: false                                                                                 // Отключение source maps для CSS в режиме разработки (улучшает производительность)
  },
  
  optimizeDeps: {                                                                                       // Настройки оптимизации зависимостей
    noDiscovery: false,                                                                                 // Разрешение автоматического обнаружения зависимостей в исходном коде
    include: []                                                                                         // Список дополнительных пакетов для принудительного включения в предварительную сборку
  }
})
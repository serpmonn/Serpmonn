<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–î–µ–º–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ - Serpmonn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/styles.css">
    <link rel="stylesheet" href="/styles/personalization.css">
    <style>
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
        }
        
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .demo-section h2 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-card {
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        .feature-card h3 {
            color: #4a90e2;
            margin-bottom: 10px;
        }
        
        .demo-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-card {
            padding: 15px;
            background: #f0f8ff;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #4a90e2;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏</h1>
            <p>–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</p>
        </div>

        <div class="demo-section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="stats-display" id="user-stats">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <div class="demo-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>üì∞ –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h3>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–µ–Ω—Ç—ã</p>
                    <div class="demo-buttons">
                        <button class="btn btn-primary" onclick="showSourcesModal()">
                            <span class="btn-icon">‚öôÔ∏è</span>
                            –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏
                        </button>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h3>üìê –ú–∞–∫–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h3>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–∞–∫–µ—Ç: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–ª–∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π</p>
                    <div class="demo-buttons">
                        <button class="btn btn-primary" onclick="showLayoutModal()">
                            <span class="btn-icon">üìê</span>
                            –í—ã–±—Ä–∞—Ç—å –º–∞–∫–µ—Ç
                        </button>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h3>üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π</h3>
                    <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π</p>
                    <div class="demo-buttons">
                        <button class="btn btn-primary" onclick="showCategoriesModal()">
                            <span class="btn-icon">üè∑Ô∏è</span>
                            –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üéØ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
            <div id="recommendations-display">
                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <div class="demo-section">
            <h2>üîß –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>üìà –°–∏–º—É–ª—è—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h3>
                    <p>–°–∏–º—É–ª–∏—Ä—É–π—Ç–µ —á—Ç–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</p>
                    <div class="demo-buttons">
                        <button class="btn btn-secondary" onclick="simulateArticleRead()">
                            <span class="btn-icon">üìñ</span>
                            –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é
                        </button>
                        <button class="btn btn-secondary" onclick="simulateSearch()">
                            <span class="btn-icon">üîç</span>
                            –ü–æ–∏—Å–∫
                        </button>
                    </div>
                </div>
                
                <div class="feature-card">
                    <h3>üîÑ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö</h3>
                    <p>–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</p>
                    <div class="demo-buttons">
                        <button class="btn btn-secondary" onclick="resetPersonalization()">
                            <span class="btn-icon">üîÑ</span>
                            –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üì± –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</h2>
            <div class="demo-buttons">
                <a href="/main.html" class="btn btn-primary">
                    <span class="btn-icon">üè†</span>
                    –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                </a>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã -->
    <script type="module" src="/scripts/personalization.js"></script>
    <script type="module" src="/scripts/enhanced-news.js"></script>
    <script type="module" src="/scripts/layout-manager.js"></script>
    
    <script type="module">
        import { personalizationManager } from '/scripts/personalization.js';
        import enhancedNewsManager from '/scripts/enhanced-news.js';
        import layoutManager from '/scripts/layout-manager.js';

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–µ–º–æ
        window.showSourcesModal = () => {
            enhancedNewsManager.showPersonalizationModal();
        };

        window.showLayoutModal = () => {
            layoutManager.showLayoutSelector();
        };

        window.showCategoriesModal = () => {
            enhancedNewsManager.showPersonalizationModal();
        };

        window.simulateArticleRead = () => {
            const sources = ['ria', 'lenta', 'tass', 'kommersant'];
            const categories = ['general', 'business', 'sport'];
            const randomSource = sources[Math.floor(Math.random() * sources.length)];
            const randomCategory = categories[Math.floor(Math.random() * categories.length)];
            
            personalizationManager.markArticleAsRead(
                `demo-article-${Date.now()}`,
                randomSource,
                randomCategory
            );
            
            updateStats();
            showNotification('–°—Ç–∞—Ç—å—è –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–∞—è!');
        };

        window.simulateSearch = () => {
            const searchQueries = [
                '–Ω–æ–≤–æ—Å—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
                '–∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞',
                '—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã',
                '–ø–æ–≥–æ–¥–∞ –º–æ—Å–∫–≤–∞',
                '–Ω–æ–≤–æ—Å—Ç–∏ —ç–∫–æ–Ω–æ–º–∏–∫–∏'
            ];
            const randomQuery = searchQueries[Math.floor(Math.random() * searchQueries.length)];
            
            personalizationManager.addSearchQuery(randomQuery);
            
            updateStats();
            showNotification(`–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å "${randomQuery}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏—Å—Ç–æ—Ä–∏—é!`);
        };

        window.resetPersonalization = () => {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏?')) {
                // –û—á–∏—â–∞–µ–º cookies
                document.cookie = 'user_preferences=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
                document.cookie = 'user_behavior=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                location.reload();
            }
        };

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const stats = personalizationManager.getUserStats();
            const statsContainer = document.getElementById('user-stats');
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.totalArticles}</div>
                    <div class="stat-label">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å—Ç–∞—Ç–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.favoriteSourcesCount}</div>
                    <div class="stat-label">–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.daysActive}</div>
                    <div class="stat-label">–î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${personalizationManager.getSearchHistory().length}</div>
                    <div class="stat-label">–ü–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</div>
                </div>
            `;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        function updateRecommendations() {
            const recommendations = personalizationManager.getPersonalizedRecommendations();
            const container = document.getElementById('recommendations-display');
            
            container.innerHTML = `
                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>üì∞ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h3>
                        <div class="source-list">
                            ${recommendations.sources.map(sourceId => {
                                const source = personalizationManager.getAllNewsSources()[sourceId];
                                return source ? `
                                    <div class="source-item">
                                        <span class="source-icon">${source.icon}</span>
                                        <span class="source-name">${source.name}</span>
                                    </div>
                                ` : '';
                            }).join('')}
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <h3>üè∑Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                        <div class="category-list">
                            ${recommendations.categories.map(categoryId => {
                                const category = personalizationManager.getAllNewsCategories()[categoryId];
                                return category ? `
                                    <div class="category-item">
                                        <span class="category-icon">${category.icon}</span>
                                        <span class="category-name">${category.name}</span>
                                    </div>
                                ` : '';
                            }).join('')}
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <h3>üìê –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–∞–∫–µ—Ç</h3>
                        <div class="layout-recommendation">
                            <span class="layout-icon">üìê</span>
                            <span class="layout-name">${layoutManager.getLayoutDisplayName(recommendations.layout)}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'news-error';
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.left = '50%';
            notification.style.transform = 'translateX(-50%)';
            notification.style.zIndex = '9999';
            notification.innerHTML = `
                <div class="error-content">
                    <span class="error-icon">‚úÖ</span>
                    <p>${message}</p>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            updateRecommendations();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                updateStats();
                updateRecommendations();
            }, 5000);
        });
    </script>
</body>
</html>